%h1
  Your Mailing Campaigns
- if @session_user.active_campaign
  %h3
    Active Campaign
    = link_to '(clear active)', freemailer_campaign_clear_active_path
  %p
    %b= @session_user.active_campaign.title
  %p
    %b= @session_user.active_campaign.subject
    %br
    = text_area_tag 'Preview', @session_user.active_campaign.preview, :disabled => true, :cols => 40
%table
  %tr
    %th Title
    %th Subject
    %th Contacts
    %th From
    %th Status
  - @freemailer_campaigns.each do |freemailer_campaign|
    %tr
      %td
        = h freemailer_campaign.title
      %td
        = h freemailer_campaign.subject
      %td
        == (#{freemailer_campaign.contacts.count}) #{h freemailer_campaign.contact_names}
      %td
        = h freemailer_campaign.from
      %td
        - if freemailer_campaign.sent
          Sent
          = link_to "(#{freemailer_campaign.successfully_sent}/#{freemailer_campaign.contacts.count})"
        - else
          Unsent.
          = link_to 'Send?', freemailer_campaign_send_campaign_path(freemailer_campaign)
      %td
        - if @session_user.active_campaign == freemailer_campaign
          = link_to 'Clear Active)', freemailer_campaign_clear_active_path 
        - else
          = link_to 'Make Active', freemailer_campaign_make_active_path(freemailer_campaign)
      %td
        = link_to 'Show', freemailer_campaign
      %td
        = link_to 'Edit', edit_freemailer_campaign_path(freemailer_campaign)
      %td
        = link_to 'Destroy', freemailer_campaign, :confirm => 'Are you sure?', :method => :delete

